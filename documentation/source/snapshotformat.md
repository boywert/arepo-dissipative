*****************
Simulation output
*****************

Particle data 
=============


Arepo supports various formats for in- and output, which are essentially the same
as in Gadget-2. Format 1 and format 2 are binary outputs and the main reason
why they are still supported is to allow the use of initial conditions from 
well-tested initial condition codes that write one of these formats.
For output (or when creating new initial condition generating code), the 
authors recommend the format 3, which is an HDF5 format. Many of the examples
create the initial conditions in HDF5 with the ``examples/*/create.py`` python 
script.


.. table:: **Fields for the particle data output**

    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Field name                  | Block ID     | Units                                                                                                            | Description                                                                                                                         |
    +=============================+==============+==================================================================================================================+=====================================================================================================================================+
    | Coordinates                 | POS          | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                    | Comoving position; for cells: position of mesh-generating point                                                                     |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Velocities                  | VEL          | :math:`\text{UnitVelocity}` :math:`a^{0.5}`                                                                      | Velocity                                                                                                                            |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | ParticleIDs                 | ID           |                                                                                                                  | Unique ID of particle                                                                                                               |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Masses                      | MASS         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                           | Mass, if not present: header/MassTable                                                                                              |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Potential                   | POT          | :math:`\text{UnitVelocity}^2` :math:`a^{-1}`                                                                     | Gravitational potential energy (``OUTPUTPOTENTIAL``)                                                                                |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | InternalEnergy              | U            | :math:`\text{UnitVelocity}^2`                                                                                    | Specific internal energy                                                                                                            |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Density                     | RHO          | :math:`\text{UnitMass}` :math:`\text{UnitLength}^{-3}` :math:`a^{-3} \, h^2`                                     | Density of gas                                                                                                                      |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Pressure                    | PRES         | :math:`\text{UnitLength}^{-3}` :math:`\text{UnitMass}^1` :math:`\text{UnitVelocity}^2` :math:`a^{-3} \, h^2`     | Thermal pressure of gas (``OUTPUT_PRESSURE``)                                                                                       |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SoundSpeed                  | CSND         | :math:`\text{UnitVelocity}`                                                                                      | Effective sound speed of both thermal and magnetic component (note different `a` scaling compared to VEL!) (``OUTPUT_CSND``)        |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | ElectronAbundance           | NE           |                                                                                                                  | Electron number density relative to hydrogen (``COOLING``)                                                                          |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | NeutralHydrogenAbundance    | NH           |                                                                                                                  | Neutral hydrogen fraction (``COOLING``)                                                                                             |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | StarFormationRate           | SFR          | :math:`\text{Msun} \, \text{yr}^{-1}`                                                                            | Star formation rate (``USE_SFR``)                                                                                                   |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | VelocityDivergence          | DIVV         | :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-1}` :math:`h`                                             | Velocity divergence (``OUTPUT_DIVVEL``)                                                                                             |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | VelocityCurl                | ROTV         | :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-1}` :math:`h`                                             | Rotation of velocity (``OUTPUT_CURLVEL``)                                                                                           |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | CoolingHeatingEnergy        | COHE         | :math:`\text{UnitLength}^{-1}` :math:`\text{UnitVelocity}^3` :math:`\text{UnitMass}`                             | Actual cooling rate, differing from nominal cooling rate in star forming cells (``OUTPUT_COOLHEAT``)                                |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SurfaceArea                 | AREA         | :math:`\text{UnitLength}^2` :math:`a^2 \, h^{-2}`                                                                | Surface area of a Voronoi cell (``OUTPUT_SURFACE_AREA``)                                                                            |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | NumFacesCell                | NFAC         |                                                                                                                  | Number of faces of a Voronoi cell (``OUTPUT_SURFACE_AREA``)                                                                         |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | CoolingRate                 | COOR         | :math:`\text{erg} \, \text{cm}^3 \, \text{s}^{-1}`                                                               | The cooling rate of a gas cell (e.g. Lambda_net/n_H^2). (``OUTPUTCOOLRATE``)                                                        |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Vorticity                   | VORT         | :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-1}` :math:`h`                                             | Vorticity of a cell (``OUTPUT_VORTICITY``)                                                                                          |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | PressureGradient            | GRAP         | :math:`\text{UnitLength}^{-4}` :math:`\text{UnitMass}` :math:`\text{UnitVelocity}^2` :math:`a^{-4} \, h^3`       | Gradient of the pressure (limited) (``OUTPUT_PRESSURE_GRADIENT``)                                                                   |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | DensityGradient             | GRAR         | :math:`\text{UnitLength}^{-4}` :math:`\text{UnitMass}` :math:`a^{-4} \, h^3`                                     | Gradient of the density (limited) (``OUTPUT_DENSITY_GRADIENT``)                                                                     |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | VelocityGradient            | GRAV         | :math:`\text{UnitLength}^{-1}` :math:`\text{UnitVelocity}^1` :math:`h`                                           | Gradient of the velocity (limited) (``OUTPUT_VELOCITY_GRADIENT``)                                                                   |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | BfieldGradient              | GRAB         | :math:`\text{UnitMass}^{0.5}` :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-5/2}` :math:`h^2 \, a^{-3}` | Gradient of the magnetic field (limited) (``OUTPUT_BFIELD_GRADIENT``)                                                               |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Volume                      | VOL          | :math:`\text{UnitLength}^3` :math:`a^3 \, h^{-3}`                                                                | (comoving) volume of gas cell. Can be calculated by Masses / Density. (``OUTPUT_VOLUME``)                                           |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | VertexVelocity              | VEVE         | :math:`\text{UnitVelocity}` :math:`a^1`                                                                          | velocity of the mesh-generating point (``OUTPUT_VERTEX_VELOCITY``)                                                                  |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | MaxFaceAngle                | FACA         |                                                                                                                  | Maximum face angle of cell, quantifies roundness (``OUTPUT_MESH_FACE_ANGLE``)                                                       |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | CenterOfMass                | CMCE         | :math:`\text{UnitLength}` :math:`a^1 \, h^{-1}`                                                                  | Center of mass of cell. Generally not equal to position of mesh generating point ``POS`` (``OUTPUT_CENTER_OF_MASS``)                |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | task                        | TASK         |                                                                                                                  | MPI task this particle is at (``OUTPUT_TASK``)                                                                                      |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | TimebinHydro                | TBH          |                                                                                                                  | Time bin the cell is at (``OUTPUT_TIMEBIN_HYDRO``)                                                                                  |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | TimeStep                    | TSTP         | :math:`\text{UnitLength}` :math:`\text{UnitVelocity}^{-1}` :math:`h^{-1}`                                        | Timestep in code units (``OUTPUTTIMESTEP``)                                                                                         |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Acceleration                | ACCE         | :math:`\text{UnitVelocity}^2` :math:`\text{UnitLength}^{-1}` :math:`a^{-1} \, h`                                 | Acceleration due to gravitational forces, including external potential; different a scaling than internally!(``OUTPUTACCELERATION``)|
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Softenings                  | SOFT         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                    | Gravitational softening length of particle/cell (``OUTPUT_SOFTENINGS``)                                                             |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GravityInteractions         | GINT         |                                                                                                                  | Number of force calculations in tree (``OUTPUTGRAVINTERACTIONS``)                                                                   |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | MagneticField               | BFLD         | :math:`\text{UnitLength}^{-1.5}` :math:`\text{UnitMass}^{0.5}` :math:`\text{UnitVelocity}` :math:`h \, a^{-2}`   | Magnetic field (in code units but Gauss system; note that internally, the Heaviside-Lorentz system is used) (``MHD``)               |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | MagneticFieldDivergence     | DIVB         | :math:`\text{UnitLength}^{-2.5}` :math:`\text{UnitMass}^{0.5}` :math:`\text{UnitVelocity}` :math:`h^2 \, a^{-3}` | Divergence of magnetic field (``MHD``)                                                                                              |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | PassiveScalars              | PASS         |                                                                                                                  | Mass fraction of passive scalar quantity in cell (``PASSIVE_SCALARS``)                                                              |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubfindDensity              | SFDE         | :math:`\text{UnitLength}^{-3}` :math:`\text{UnitMass}` :math:`a^{-3} \, h^2`                                     | density around particle (SPH like estimate) (``SAVE_HSML_IN_SNAPSHOT``)                                                             |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubfindDMDensity            | SFDD         | :math:`\text{UnitLength}^{-3}` :math:`\text{UnitMass}` :math:`a^{-3} \, h^2`                                     | dark matter density around particle (SPH like estimate) (``SAVE_HSML_IN_SNAPSHOT``)                                                 |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubfindHsml                 | SFHS         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                    | SPH smoothing length for density estimate (``SAVE_HSML_IN_SNAPSHOT``)                                                               |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubfindVelDisp              | SFVD         | :math:`\text{UnitVelocity}`                                                                                      | SPH averaged velocity dispersion around particle (``SAVE_HSML_IN_SNAPSHOT``)                                                        |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupNr                     | GROU         |                                                                                                                  | Number of nearest group (``FOF_FUZZ_SORT_BY_NEAREST_GROUP=1``)                                                                      |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | HighResGasMass              | HRGM         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                           | Conserved scalar quantity flaging the high-res region of a cosmological zoom simulation (``REFINEMENT_HIGH_RES_GAS``)               |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | AllowRefinement             | REF          |                                                                                                                  | Is refinement allowed in gas cell. 0 for low-resolution region gas cells in zoom simulations (``REFINEMENT_HIGH_RES_GAS``)          |
    +-----------------------------+--------------+------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+


Format 1 
--------

Format 1 is organized in blocks, each holding information about all particles
for a specific property. The first block is the header, containing global 
information about the particle set. Within the other blocks, particles are 
ordered according to their particle type. 

For a more detailed description of this file format, see the Gadget-2 user
guide (https://wwwmpa.mpa-garching.mpg.de/gadget/users-guide.pdf).


Format 2 
--------

Format 2 is a variant of format 1, but containing an additional 4-character 
string at the beginning of each block (called Block ID in table). This way,
it is possible to read the snapshot without having detailed information about
all settings that were active in the code that produced this output.


Format 3 / HDF5 
---------------

Format 3 is the by now recommended format, based on the hdf5 library. 
The particle data output consists of hdf5 groups called PartTypeX where
X runs from 0 to NTYPES-1 (NTYPES=6 if not set in Config-file).
Each of these hdf5 groups has a number of datasets with properties belonging
to this particular particle type, e.g. ``Coordinates`` for the position of 
particles. These are in general 2d arrays, where the first dimension represents
the different particles, while the second dimension is the dimensionality of 
the specific property (e.g. for ``Coordinates``, every particle has 3 entries,
its x, y and z coordinate). Consequently, for scalar quantities, the array is 
just one dimensional. 

In addition to the particle types, each file has an hdf5 group called ``Header``,
with general information about the simulation and this file in particular. 
These informations are stored in hdf5 attributes within the header group.

To facilitate the use of the snapshot, the compile time settings are also 
stored in the snapshots, saved as attributes in the group ``Config``, as well as
the parameter settings in the group ``Parameters``.
To be sure it is however advisable to check the ``./build/arepoconfig.h`` and the
``./output/parameters-usedvalues`` files for the compile time and run-time 
variables of a given simulation.


FOF/Subfind 
===========

The halo and subhalo finder produces a separate output file, summarizing the 
properties determined by the on the fly analysis. These run immediately 
before every simulation output, and also sort the particles in the particle 
data output according to group membership, subhalo membership and binding 
energy.

The (sub)halo output files have two hdf5 groups containing halo data, called 
``Group``, for the properties of groups (identified by the Friend-of-Friends 
algorithm), and ``Subhalo``, for substructures in groups.


.. table:: **Halo fields in group catalogue files**
    
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group field name            | Block ID     | Units                                                                                                          | Description                                                                                                                         |
    +=============================+==============+================================================================================================================+=====================================================================================================================================+
    | GroupLen                    | FLEN         |                                                                                                                | Number of particles/cells in group                                                                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupMass                   | FMAS         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of masses of all particles in group                                                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupPos                    | FPOS         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Position of the most bound particle in group                                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupCM                     | FGCM         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Position of center of mass of group                                                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupVel                    | FVEL         | :math:`\text{UnitVelocity}` :math:`a^{-1}`                                                                     | Velocity of the group, computed as the sum of the mass weighted velocities of all particles/cells in this group, of all types.      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupLenType                | FLTY         |                                                                                                                | Number of particles of given type in group                                                                                          |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupMassType               | FMTY         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of particle masses of given type                                                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupSFR                    | FSFR         | :math:`\text{Msun}` :math:`\text{yr}^{-1}`                                                                     | Cumulative star formation rate of all gas cells in group                                                                            |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_M_Mean200             | FMM2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass within a sphere with mean density of 200 times the mean density of the Universe.                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_R_Mean200             | FRM2         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Radius of sphere corresponding to ``Group_M_Mean200``                                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_M_Crit200             | FMC2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass within a sphere around ``GroupPos`` with mean density of 200 times the critical density of the Universe.                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_R_Crit200             | FRC2         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Radius of sphere corresponding to ``Group_M_Crit200``                                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_M_Crit500             | FMC5         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass within a sphere around ``GroupPos`` with mean density of 500 times the critical density of the Universe.                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_R_Crit500             | FRC5         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Radius of sphere corresponding to ``Group_M_Crit500``                                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_M_TopHat200           | FMT2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass within a sphere around ``GroupPos`` with mean density having a specific fraction of the mean density of the Universe.    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_R_TopHat200           | FRT2         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Radius of sphere corresponding to ``Group_M_TopHat200``                                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupNsubs                  | FNSH         |                                                                                                                | Number of subhalos identified in this group                                                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupFirstSub               | FFSH         |                                                                                                                | (Global) index of first subhalo in this group. -1 if there are none.                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupFuzzOffsetType         | FUOF         |                                                                                                                | Particle offset (for each type) of fuzzy particles.                                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

|

.. table:: **Subhalo fields in group catalogue files**

    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo field name          | Block-ID     | Units                                                                                                          | Description                                                                                                                         |
    +=============================+==============+================================================================================================================+=====================================================================================================================================+
    | SubhaloLen                  | SLEN         |                                                                                                                | Total number of particles/cells in this subhalo                                                                                     |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMass                 | SMAS         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass of all particles in this subhalo, child subhalos not included                                                            |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloPos                  | SPOS         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Position of most bound particle in subhalo                                                                                          |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloVel                  | SVEL         | :math:`\text{UnitVelocity}`                                                                                    | Physical velocity of subhalo                                                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloLenType              | SLTY         |                                                                                                                | Number of particle of each type in a subhalo                                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassType             | SMTY         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Mass of each particle type in a subhalo                                                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloCM                   | SCMP         | :math:`\text{UnitLength}` :math:`a \, h^{-1}`                                                                  | Center of mass of subhalo                                                                                                           |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloSpin                 | SSPI         | :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-1}`                                           | Total spin in each coordinate axis from all subhalo particles/cells                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloVelDisp              | SVDI         | :math:`\text{UnitVelocity}`                                                                                    | 1d velocity dispersion                                                                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloVmax                 | SVMX         | :math:`\text{UnitVelocity}`                                                                                    | Maximum circular velocity                                                                                                           |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloVmaxRad              | SVRX         | :math:`\text{UnitLength}` :math:`a` :math:`h^{-1}`                                                             | Radius of maximum circular velocity                                                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloHalfmassRad          | SHMR         | :math:`\text{UnitLength}` :math:`a` :math:`h^{-1}`                                                             | Radius containing half the mass of the subhalo                                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloHalfmassRadType      | SHMT         | :math:`\text{UnitLength}` :math:`a` :math:`h^{-1}`                                                             | Radius containing half the mass of a given type of particles in the subhalo                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInRad            | SMIR         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of all particle masses enclosed in a sphere with twice the part4 (i.e. stellar) half mass radius                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInHalfRad        | SMIH         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of all particle masses enclosed in a sphere with the part4 (i.e. stellar) half mass radius                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInMaxRad         | SMIM         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of all particle masses enclosed in a sphere with radius ``SubhaloVmaxRad``                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInRadType        | SMIT         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of particle masses of specific type particles enclosed in a sphere with twice the part4 (i.e. stellar) half mass radius         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInHalfRadType    | SMHT         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of particle masses of specific type particles enclosed in a sphere with the part4 (i.e. stellar) half mass radius               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloMassInMaxRadType     | SMMT         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Sum of particle masses of specific type particles enclosed in a sphere with radius ``SubhaloVmaxRad``                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloIDMostbound          | SIDM         |                                                                                                                | The ID of the most bound particle                                                                                                   |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloGrNr                 | SGNR         |                                                                                                                | Global index of the (FoF) group this subhalo belongs to                                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloParent               | SPRT         |                                                                                                                | Index of a potential parent subhalo this subhalo is part of                                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloBfldHalo             | BFDH         | :math:`\text{UnitMass}^{0.5}` :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-1.5}` :math:`h \, a^{-2}` | Volume averaged magnetic field strength in subhalo (Gauss unit system, not Heaviside-Lorentz)                                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloBfldDisk             | BFDD         | :math:`\text{UnitMass}^{0.5}` :math:`\text{UnitVelocity}` :math:`\text{UnitLength}^{-1.5}` :math:`h \, a^{-2}` | Volume averaged magnetic field strength within twice the stellar half mass radius (Gauss unit system, not Heaviside-Lorentz)        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloSFR                  | SSFR         | :math:`\text{Msun} \, \text{yr}^{-1}`                                                                          | Sum of star formation rates of all gas cells in the subhalo                                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloSFRinRad             | SSFI         | :math:`\text{Msun} \, \text{yr}^{-1}`                                                                          | Sum of star formation rates of all gas cells within twice the stellar half mass radius                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloSFRinHalfRad         | SSFH         | :math:`\text{Msun} \, \text{yr}^{-1}`                                                                          | Sum of star formation rates of all gas cells within the stellar half mass radius                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloSFRinMaxRad          | SSFM         | :math:`\text{Msun} \, \text{yr}^{-1}`                                                                          | Sum of star formation rates of all gas cells within a sphere with radius ``SubhaloVmaxRad``                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | ID                          | PIDS         |                                                                                                                | Particle IDs in subhalo                                                                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

|

.. table:: **Additional group fields that are calculated when** ``SUBFIND_EXTENDED_PROPERTIES`` **is set**
    
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group field name            | Block ID     | Units                                                                                                          | Description                                                                                                                         |
    +=============================+==============+================================================================================================================+=====================================================================================================================================+
    | Group_J_Mean200             | FJM2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in group within ``Group_R_Mean200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jdm_Mean200           | JDM2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles in group within ``Group_R_Mean200``                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jgas_Mean200          | JGM2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas particles in group within ``Group_R_Mean200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jstars_Mean200        | JSM2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star matter particles in group within ``Group_R_Mean200``                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_MassType_Mean200      | MTM2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass of group for each particle type within ``Group_R_Mean200``                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_LenType_Mean200       | LTM2         |                                                                                                                | Total number of particles for each particle type within ``Group_R_Mean200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFrac_Mean200        | CFM2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Mean200``                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFracType_Mean200    | FTM2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Mean200`` for each type                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_J_Crit200             | FJC2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in group within ``Group_R_Crit200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jdm_Crit200           | JDC2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles in group within ``Group_R_Crit200``                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jgas_Crit200          | JGC2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas particles in group within ``Group_R_Crit200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jstars_Crit200        | JSC2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles in group within ``Group_R_Crit200``                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_MassType_Crit200      | MTC2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass of group for each particle type within ``Group_R_Crit200``                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_LenType_Crit200       | LTC2         |                                                                                                                | Total number of particles for each particle type within ``Group_R_Crit200``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFrac_Crit200        | CFC2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Crit200``                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFracType_Crit200    | FTC2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Crit200`` for each type                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_J_Crit500             | FJC5         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in group within ``Group_R_Crit500``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jdm_Crit500           | JDC5         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   |  Total angular momentum of dark matter particles in group within ``Group_R_Crit500``                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jgas_Crit500          | JGC5         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas particles in group within ``Group_R_Crit500``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jstars_Crit500        | JSC5         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles in group within ``Group_R_Crit500``                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_MassType_Crit500      | MTC5         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass of group for each particle type within ``Group_R_Crit500``                                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_LenType_Crit500       | LTC5         |                                                                                                                | Total number of particles for each particle type within ``Group_R_Crit500``                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFrac_Crit500        | CFC5         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Crit500``                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFracType_Crit500    | FTC5         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_Crit500`` for each type                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_J_TopHat200           | FJT2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in group within ``Group_R_TopHat200``                                                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jdm_TopHat200         | JDT2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles in group within ``Group_R_TopHat200``                                               |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jgas_TopHat200        | JGT2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas particles in group within ``Group_R_TopHat200``                                                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jstars_TopHat200      | JST2         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles in group within ``Group_R_TopHat200``                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_MassType_TopHat200    | MTT2         | :math:`\text{UnitMass}` :math:`h^{-1}`                                                                         | Total mass of group for each particle type within ``Group_R_TopHat200``                                                             |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_LenType_TopHat200     | LTT2         |                                                                                                                | Total number of particles for each particle type within ``Group_R_TopHat200``                                                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFrac_TopHat200      | CFT2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_TopHat200``                                                            |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFracType_TopHat200  | FTT2         |                                                                                                                | Mass fraction of counter-rotating particles within ``Group_R_TopHat200`` for each type                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Epot_Crit200          | EPO1         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of particles within ``Group_R_Crit200``                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ekin_Crit200          | EKI1         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of particles within ``Group_R_Crit200``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ethr_Crit200          | ETH1         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of particles within ``Group_R_Crit200``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Epot_Mean200          | EPO2         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of particles within ``Group_R_Mean200``                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ekin_Mean200          | EKI2         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of particles within ``Group_R_Mean200``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ethr_Mean200          | ETH2         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of particles within ``Group_R_Mean200``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Epot_TopHat200        | EPO3         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of particles within ``Group_R_TopHat200``                                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ekin_TopHat200        | EKI3         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of particles within ``Group_R_TopHat200``                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ethr_TopHat200        | ETH3         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of particles within ``Group_R_TopHat200``                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Epot_Crit500          | EPO4         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of particles within ``Group_R_Crit500``                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ekin_Crit500          | EKI4         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of particles within ``Group_R_Crit500``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Ethr_Crit500          | ETH4         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of particles within ``Group_R_Crit500``                                                                        |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_J                     | FOFJ         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity} \, h^{-2}`                        | Total angular momentum of all particles in fof-group                                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jdm                   | FOJD         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity} \, h^{-2}`                        | Total angular momentum of all dark matter particles in fof-group                                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jgas                  | FOJG         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity} h^{-2}`                           | Total angular momentum of all gas cells in fof-group                                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_Jstars                | FOJS         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity} \, h^{-2}`                        | Total angular momentum of all stars in fof-group                                                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFrac                | FOCF         |                                                                                                                | Mass fraction of counter-rotating particles in fof-group                                                                            |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Group_CMFracType            | FOFT         |                                                                                                                | Mass fraction of counter-rotating particles in fof-group for each type                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupEkin                   | EKIN         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of all particles in fof-group                                                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupEthr                   | ETHR         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of all particles in fof-group                                                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | GroupEpot                   | EPOT         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of all particles in fof-group                                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

|

.. table:: **Additional subhalo fields that are calculated when** ``SUBFIND_EXTENDED_PROPERTIES`` **is set**
    
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo field name          | Block ID     | Units                                                                                                          | Description                                                                                                                         |
    +=============================+==============+================================================================================================================+=====================================================================================================================================+
    | SubhaloEkin                 | SEKN         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total kinetic energy of all particles in subhalo                                                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloEthr                 | SETH         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total thermal energy of all particles in subhalo                                                                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | SubhaloEpot                 | SEPT         | :math:`\text{UnitMass}` :math:`\text{UnitVelocity}` :math:`a^{-2} \, h^{-1}`                                   | Total potential energy of all particles in subhalo                                                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_J                   | SUBJ         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in subhalo                                                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_Jdm                 | SJDM         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles in subhalo                                                                          |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_Jgas                | SJGS         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas cells in subhalo                                                                                      |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_Jstars              | SJST         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles in subhalo                                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JInHalfRad          | SJHR         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in stellar half mass radius                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JdmInHalfRad        | SJDH         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles within stellar half mass radius                                                     |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JgasInHalfRad       | SJGH         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas cells within stellar half mass radius                                                                 |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JstarsInHalfRad     | SJSH         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles within stellar half mass radius                                                            |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JInRad              | SJMR         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of all particles in sphere with radius twice the stellar half mass radius                                    |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JdmInRad            | SJDR         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of dark matter particles within twice the stellar half mass radius                                           |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JgasInRad           | SJGR         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of gas cells within twice the stellar half mass radius                                                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_JstarsInRad         | SJSR         | :math:`\text{UnitMass}` :math:`\text{UnitLength}` :math:`\text{UnitVelocity}` :math:`h^{-2}`                   | Total angular momentum of star particles within twice the stellar half mass radius                                                  |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFrac              | SCMF         |                                                                                                                | Mass fraction of counter-rotating particles in subhalo                                                                              |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFracType          | SCMT         |                                                                                                                | Mass fraction of counter-rotating particles in subhalo for each type                                                                |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFracInHalfRad     | SCMH         |                                                                                                                | Mass fraction of counter-rotating particles within stellar half mass radius                                                         |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFracTypeInHalfRad | SCTH         |                                                                                                                | Mass fraction of counter-rotating particles within stellar half mass radius for each type                                           |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFracInRad         | SCMR         |                                                                                                                | Mass fraction of counter-rotating particles in a sphere with twice the stellar half mass radius                                     |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
    | Subhalo_CMFracTypeInRad     | SCTR         |                                                                                                                | Mass fraction of counter-rotating particles in a sphere with twice the stellar half mass radius for each type                       |
    +-----------------------------+--------------+----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+


